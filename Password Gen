import random
import string
import math

class PassGen:
    def __init__(self, length=12, use_symbols=True, use_upper=True, use_numbers=True):
        self.length = length
        self.use_symbols = use_symbols
        self.use_upper = use_upper
        self.use_numbers = use_numbers
        self.password = ""

    def gen_password(self):
        charset = string.ascii_lowercase
        if self.use_upper:
            charset += string.ascii_uppercase
        if self.use_numbers:
            charset += string.digits
        if self.use_symbols:
            charset += string.punctuation

        self.password = ''.join(random.choice(charset) for _ in range(self.length))
        return self.password

    def entropy_meter(self):
        charset_size = 26
        if self.use_upper:
            charset_size += 26
        if self.use_numbers:
            charset_size += 10
        if self.use_symbols:
            charset_size += len(string.punctuation)

        entropy = self.length * math.log2(charset_size)
        return round(entropy, 2)

    def report(self):
        return {
            "password": self.password or self.gen_password(),
            "entropy_bits": self.entropy_meter(),
            "length": self.length,
            "charset": {
                "symbols": self.use_symbols,
                "uppercase": self.use_upper,
                "numbers": self.use_numbers
            }
        }
